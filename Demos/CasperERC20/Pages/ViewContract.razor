@page "/contract/{ContractHash}"

@inherits BlazorDelegate.Pages.ExplorerComponent

<div class="container">
    <div class="row">
        <div class="col-md-12 col-lg-10 col-xl-8 mx-auto">
            <RadzenTabs RenderMode="TabRenderMode.Client">
                <Tabs>
                    <RadzenTabsItem Text="Details">
                        @if (ERC20Client.Name == null)
                        {
                            <RadzenLabel Text="Loading..." Visible="@(_detailsError== null || !_detailsError.Visible)" />
                            <CasperClientError @ref="_detailsError" />
                        }
                        else
                        {
                            <table class="table table-hover">
                                <tbody>
                                <tr>
                                    <th scope="row">Name</th>
                                    <td>@ERC20Client.Name</td>
                                </tr>
                                <tr>
                                    <th scope="row">Symbol</th>
                                    <td>@ERC20Client.Symbol</td>
                                </tr>
                                <tr>
                                    <th scope="row">Decimals</th>
                                    <td>@ERC20Client.Decimals</td>
                                </tr>
                                <tr>
                                    <th scope="row">Total Supply</th>
                                    <td>@ERC20Client.TotalSupply</td>
                                </tr>
                                </tbody>
                            </table>
                        }
                    </RadzenTabsItem>
                    <RadzenTabsItem Text="Balance" Disabled="@(_detailsError== null || _detailsError.Visible)">

                        <div class="row px-3">
                            <PublicKeyTextBox Text="Public Key" SignerRef="@SignerInterop" @bind-Value="@SubjectPK"/>
                            <div>
                                <RadzenButton class="mt-4 w-100" Click=@(args => OnGetBalanceClick()) Text="Get Balance"/>
                            </div>
                                <CasperClientError @ref="_getBalanceError"></CasperClientError>
                            @if (BalanceOf != null && _getBalanceError.Visible == false)
                            {
                                <div>
                                    <table class="table mt-4">
                                        <tbody>
                                        <tr>
                                            <th scope="row">Public Key</th>
                                            <td>@SubjectPK</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Balance</th>
                                            <td>@BalanceOf</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            }
                        </div>
                    </RadzenTabsItem>
                    <RadzenTabsItem Text="Allowance" Disabled="@(_detailsError== null || _detailsError.Visible)">
                        <div class="row px-3">
                            <PublicKeyTextBox Text="Owner Public Key" SignerRef="@SignerInterop" @bind-Value="@OwnerPK"/>

                            <PublicKeyTextBox Class="mt-4" Text="Spender Public Key"SignerRef="@SignerInterop" @bind-Value="@SpenderPK"/>

                            <div>
                                <RadzenButton class="mt-4 w-100" Click=@(OnGetAllowanceClick) Text="Get Allowance"/>
                            </div>

                                <CasperClientError @ref="_getAllowanceError"></CasperClientError>
                            @if (ApprovedBalance != null && _getAllowanceError.Visible == false)
                            {
                                <table class="table table-hover mt-4">
                                    <tbody>
                                    <tr>
                                        <th scope="row">Owner Public Key</th>
                                        <td>@OwnerPK</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Spender Public Key</th>
                                        <td>@SpenderPK</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Approved Balance</th>
                                        <td>@ApprovedBalance</td>
                                    </tr>
                                    </tbody>
                                </table>
                            }
                        </div>

                    </RadzenTabsItem>
                    <RadzenTabsItem Text="Transfer" Disabled="@(_detailsError== null || _detailsError.Visible)">
                        <div class="row px-3">
                            <ERC20TransferTo ERC20Client="@ERC20Client" />
                        </div>
                    </RadzenTabsItem>
                    <RadzenTabsItem Text="Approve spender" Disabled="@(_detailsError== null || _detailsError.Visible)">
                        <div class="row px-3">
                            <ERC20ApproveSpender ERC20Client="@ERC20Client" />
                        </div>
                    </RadzenTabsItem>
                    <RadzenTabsItem Text="Transfer from" Disabled="@(_detailsError== null || _detailsError.Visible)">
                        <div class="row px-3">
                            <ERC20TransferFrom ERC20Client="@ERC20Client" />
                        </div>
                    </RadzenTabsItem>

                </Tabs>
            </RadzenTabs>
        </div>

    </div>
</div>
